/* === PDF PRINT STYLES (Black & White, A4) === */
@media print {
    @page {
        size: A4 portrait; /* Ensure 'portrait' is specified if intended */
        margin: 1.5cm 1cm; /* Top/Bottom 1.5cm, Left/Right 1cm, adjust as needed */
    }

    /* --- General Body & Layout --- */
    body {
        background-color: #ffffff !important;
        color: #000000 !important;
        font-family: 'Times New Roman', Times, serif; /* Classic print font */
        font-size: 11pt !important; /* Common print font size */
        line-height: 1.4 !important; /* Readable line height for print */
        -webkit-print-color-adjust: economy; /* Prioritize B&W */
        color-adjust: economy;
    }

    .markdown-preview {
        font-family: inherit !important; /* Inherit from body */
        font-weight: normal !important; /* Standard weight for print */
        font-size: inherit !important; /* Inherit from body */
        line-height: inherit !important; /* Inherit from body */
        padding: 0 !important;
        margin: 0 !important;
        color: #000000 !important;
        background-color: #ffffff !important;
        border: none !important;
        box-shadow: none !important;
        max-width: none !important;
    }

    /* --- Typography --- */
    p {
        margin-top: 0.3em;
        margin-bottom: 0.6em;
        orphans: 2;
        widows: 2;
    }

    strong, b {
        font-weight: bold !important;
        color: #000000 !important;
    }

    em, i {
        font-style: italic !important;
        color: #000000 !important;
    }

    /* --- Headings --- */
    h1, h2, h3, h4, h5, h6 {
        margin-top: 1em;
        margin-bottom: 0.4em;
        color: #000000 !important;
        border-bottom: none !important;
        padding-bottom: 0 !important;
        font-family: inherit; /* Or a sans-serif like Arial, Helvetica for contrast */
        font-weight: bold !important;
        page-break-after: avoid;
        page-break-inside: avoid;
        orphans: 2; /* Keep at least 2 lines of heading with following paragraph */
        widows: 2;
    }
    h1 { font-size: 18pt !important; margin-top: 0; /* Often starts a new section/page */ }
    h2 { font-size: 15pt !important; }
    h3 { font-size: 13pt !important; }
    h4 { font-size: 12pt !important; font-style: italic; }
    h5 { font-size: 11pt !important; font-weight: bold !important; }
    h6 { font-size: 11pt !important; font-style: italic; }

    /* Special headings (make them simple text for B&W) */
    h2[id^='you'], h2[id^='me'] {
        background-color: transparent !important;
        color: #000000 !important;
        text-align: left !important; /* Reset from main style */
        padding: 0 !important;
        font-size: 14pt !important; /* Match h2 */
        font-style: italic;
        margin-bottom: 0.5em;
    }
    h2[id^='you']::before { content: "Speaker (You): "; font-weight: bold; }
    h2[id^='me']::before { content: "Speaker (Me): "; font-weight: bold; }


    /* --- Lists --- */
    ul, ol {
        padding-left: 1.8em; /* More distinct indent for print */
        margin-top: 0.3em;
        margin-bottom: 0.6em;
    }
    li {
        margin-bottom: 0.2em;
        page-break-inside: auto; /* Allow items to split if long */
    }
    li > p {
        margin-top: 0.1em;
        margin-bottom: 0.1em;
    }

    /* --- Blockquotes --- */
    blockquote {
        margin: 0.8em 0 0.8em 1em; /* Indent slightly */
        padding: 0.5em 1em;
        border-left: 3px solid #cccccc !important;
        color: #333333 !important; /* Slightly lighter for quoted text */
        background-color: #f5f5f5 !important; /* Very light gray background */
        font-style: italic;
        page-break-inside: avoid;
    }
    blockquote p:last-child { margin-bottom: 0; }

    /* --- Horizontal Rules --- */
    hr {
        margin: 1em 0;
        height: 1px;
        border: 0;
        background-color: #bbbbbb !important; /* Darker gray for HR */
        page-break-after: avoid; /* Avoid breaking page immediately after HR */
    }

    /* --- Tables --- */
    table {
        margin: 1em 0;
        font-size: 9pt !important; /* Smaller for tables */
        border-collapse: collapse;
        width: 100%;
        page-break-inside: avoid; /* Try to keep tables on one page */
    }
    th, td {
        padding: 0.2em 0.4em;
        border: 1px solid #aaaaaa !important; /* Clearer border for B&W */
        color: #000000 !important;
        background-color: #ffffff !important;
        vertical-align: top;
    }
    th {
        background-color: #e0e0e0 !important; /* Light gray for headers */
        font-weight: bold !important;
        text-align: left;
    }
    tr:nth-child(even) td { background-color: #f7f7f7 !important; } /* Subtle striping if desired */
    tr:nth-child(odd) td { background-color: #ffffff !important; }


    /* --- Images --- */
    img {
        padding: 0 !important;
        margin: 1em auto;
        border: 1px solid #bbbbbb !important;
        background-color: transparent !important; /* No background for images */
        max-width: 90% !important; /* Slightly less than 100% to avoid edge issues */
        max-height: 70vh !important; /* Prevent overly tall images */
        display: block;
        page-break-inside: avoid; /* Try to keep image on one page */
    }

    /* --- Code Blocks & Inline Code --- */
    pre, code {
        font-family: 'Courier New', Courier, monospace !important; /* Monospaced print font */
        color: #000000 !important;
        background-color: transparent !important; /* No background for inline code */
        border: none !important; /* No border for inline code by default */
    }

    /* Inline code */
    :not(pre) > code {
        font-size: 0.9em !important; /* Relative to surrounding text */
        padding: 0.05em 0.2em !important;
        border: 1px solid #dddddd !important; /* Subtle border for inline code */
        background-color: #f8f8f8 !important; /* Very light background for inline code */
        white-space: normal; /* Allow inline code to wrap */
    }

    /* Code blocks */
    pre {
        font-size: 9pt !important; /* Consistent small size for code blocks */
        padding: 0.5em !important;
        margin: 0.8em 0 !important;
        border: 1px solid #cccccc !important;
        background-color: #f5f5f5 !important; /* Light gray background for code blocks */
        white-space: pre-wrap !important; /* Wrap long lines */
        word-wrap: break-word !important;
        page-break-inside: avoid;
        line-height: 1.3 !important;
    }
    pre code { /* Code inside pre, reset some properties */
        font-size: inherit !important;
        border: none !important;
        padding: 0 !important;
        background-color: transparent !important;
    }
    /* Remove all syntax highlighting colors for B&W print */
    pre .token { color: #000000 !important; font-style: normal !important; font-weight: normal !important; }


    /* --- Links --- */
    a, a:visited {
        color: #000000 !important;
        text-decoration: underline !important;
        word-break: break-all; /* Allow long URLs to break */
    }
    /* Show full URLs for external links */
    a[href^="http"]:not([href*="localhost"])::after,
    a[href^="https"]:not([href*="localhost"])::after {
        content: " [" attr(href) "]";
        font-size: 0.85em;
        color: #444444 !important; /* Dark gray for URL */
        font-style: normal;
        text-decoration: none !important;
        /* word-break: break-all; - already on 'a' */
        /* white-space: nowrap; - removed to allow URL wrapping */
        margin-left: 0.1em;
    }
    /* Do not show URL for internal links or mail/tel */
    a[href^="#"]::after, a[href^="mailto:"]::after, a[href^="tel:"]::after {
        content: "" !important;
    }

    /* --- KaTeX Math --- */
    .katex {
        font-size: 1em !important; /* Match surrounding text size */
        color: #000000 !important;
        page-break-inside: avoid;
    }
    .katex-display {
        padding: 0.3em 0;
        margin: 0.5em 0 !important;
        overflow-x: visible !important; /* No scroll for print */
        text-align: center;
    }
    .katex .mathnormal { /* Ensure math font is clear */
        font-family: 'Times New Roman', KaTeX_Main, serif !important;
    }
    /* Simplify KaTeX elements for B&W */
    .katex * { color: #000000 !important; background: none !important; }


    /* --- Callout Blocks (B&W friendly) --- */
    .callout {
        margin: 1em 0;
        padding: 0.5em 1em;
        border: 1px solid #999999 !important;
        background-color: #f0f0f0 !important;
        color: #000000 !important;
        border-left-width: 3px !important; /* Keep emphasis on left border */
        page-break-inside: avoid;
    }
    .callout::before {
        font-weight: bold;
        margin-right: 0.5em;
        color: #000000 !important;
    }
    .callout-info::before    { content: "[INFO] "; }
    .callout-success::before { content: "[SUCCESS] "; }
    .callout-warning::before { content: "[WARNING] "; }
    .callout-error::before   { content: "[ERROR] "; }
    .callout-tip::before     { content: "[TIP] "; }
    .callout p:last-child { margin-bottom: 0; }


    /* --- Line Breaks (Original aggressive styling - adjust for print if needed) --- */
    /* This typically should not hide br tags in print unless there's a very specific reason */
    /* For standard print, br should create a line break. */
    /* Commenting out the original br hiding for print, as it's unusual. */
    /*
    br {
        line-height: 0 !important; height: 0 !important; margin: 0 !important;
        padding: 0 !important; display: none !important; content: '' !important;
    }
    br::after {
        content: ''; display: block; margin-bottom: 0.25em;
    }
    */
    /* If hard line breaks are intended, ensure they work or use paragraph spacing. */

    /* Remove any elements specifically marked as no-print */
    .no-print, [data-no-print] {
        display: none !important;
    }
}
